import{u as D,a as g,m as I,g as F,r as q,o as L,j as e,i as u,L as c,S as R,z as d,k as S,n as $}from"./index-D8XKaJer.js";import{C as E}from"./circle-plus-yMZmLdwg.js";const T="/assets/strip-Dv9DJVXc.webp";function z({product:t,priority:r}){const i=D(),{user:m,isAuthenticated:n}=g(s=>s.auth),l=m?.role==="admin",[x,{isLoading:o}]=I(),[h,{isLoading:a}]=F(),[b,p]=q.useState(null),f=t.stock!==void 0?t.stock:t.pieces||0,v=t.description||t.desc||"",y=t.has_strips||t.stripsPerBox>0,j=t.strip_count||t.stripsPerBox||1,w=f===0,C=s=>Number.isInteger(s)?s:Number(s).toFixed(2),P=L(t.image)||"/placeholder.png",_=async()=>{if(window.confirm("Are you sure you want to delete this product?"))try{await x(t._id).unwrap(),d.success("Product deleted successfully")}catch(s){d.error("Failed to delete product",s)}},N=async s=>{if(!n){d.error("Please login to add items");return}p(s);let k=1;s==="strip"&&y&&j>0&&(k=Number((1/Math.max(1,j)).toFixed(6)));try{await h({productId:t._id,quantity:k}).unwrap(),d.success("Item added to cart!")}catch(A){d.error(A.data?.message||"Failed to add item")}finally{p(null)}};return e.jsxs("div",{className:`flex flex-col justify-between h-full p-4 rounded-xl transition-all duration-300 bg-white dark:bg-gray-800 shadow-sm hover:shadow-xl ${t.requires_prescription||t.IsRoshetta?"border-2 border-red-500 shadow-[0_0_6px_rgba(220,53,69,0.8)]":"border border-transparent dark:border-gray-700"}`,children:[e.jsx(u,{to:`/product/${t._id}`,className:"block h-60 mb-4 p-2 rounded-lg shadow-inner bg-gray-50 dark:bg-gray-700",children:e.jsx("img",{src:P,alt:t.name,className:"w-full h-full object-contain mix-blend-multiply dark:mix-blend-normal",loading:r?"eager":"lazy",fetchpriority:r?"high":"auto",decoding:"async"})}),e.jsxs("div",{className:"flex flex-col flex-grow justify-center",children:[e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:[C(f)," pieces in stock"]}),e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white mb-2 line-clamp-2 hover:text-green-600 transition-colors",children:e.jsx(u,{to:`/product/${t._id}`,children:t.name})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3 line-clamp-2",children:v}),(t.requires_prescription||t.IsRoshetta)&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm font-bold mb-2",children:"Needs Prescription"}),e.jsxs("div",{className:"flex justify-between items-center mt-auto pt-2",children:[e.jsxs("p",{className:"text-2xl font-black text-gray-900 dark:text-white",children:["$",t.price]}),!l&&e.jsxs("div",{className:"flex gap-2",children:[y&&e.jsx("button",{"aria-label":`Add one strip of ${t.name} to cart`,className:"w-11 h-11 rounded-full bg-green-700 hover:bg-green-800 disabled:bg-gray-400 flex justify-center items-center transition-transform active:scale-95",disabled:w||a||t.requires_prescription||t.IsRoshetta,onClick:()=>N("strip"),children:a&&b==="strip"?e.jsx(c,{className:"w-5 h-5 text-white animate-spin","aria-hidden":"true"}):e.jsx("img",{src:T,alt:"strip icon",className:"w-8 h-8 object-contain"})}),e.jsx("button",{"aria-label":`Add one box of ${t.name} to cart`,className:"w-11 h-11 rounded-full border-2 border-green-700 text-green-700 hover:bg-green-700 hover:text-white disabled:border-gray-400 disabled:text-gray-400 transition-all active:scale-95 flex justify-center items-center",disabled:w||a||t.requires_prescription||t.IsRoshetta,onClick:()=>N("box"),children:a&&b==="box"?e.jsx(c,{className:"w-5 h-5 animate-spin","aria-hidden":"true"}):e.jsx(R,{className:"w-5 h-5","aria-hidden":"true"})})]})]})]}),l&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[e.jsx("button",{onClick:()=>i(`/admin/edit-product/${t._id}`),className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded-lg text-sm font-bold transition-colors",children:"Edit"}),e.jsx("button",{onClick:_,disabled:o,className:"flex-1 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white py-2 rounded-lg text-sm font-bold transition-colors flex justify-center items-center",children:o?e.jsx(c,{className:"w-4 h-4 animate-spin"}):"Delete"})]})]})}function B({products:t=[]}){return e.jsx("div",{className:"w-full",children:t.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map((r,i)=>e.jsx(z,{product:r,priority:i<4},r._id))}):e.jsx("div",{className:"text-center py-10 text-gray-500 dark:text-gray-400 text-xl font-semibold",children:"No products found."})})}const M={"cold-and-flu":{title:"Cold and Flu",desc:"Cold and Flu products help relieve common symptoms such as nasal congestion, cough, fever, and headache."},"diabetes-care":{title:"Diabetes Care",desc:"Diabetes care products support blood sugar monitoring and management. They include glucose meters, test strips, and supplements."},"first-aid":{title:"First Aid",desc:"First aid products include bandages, antiseptics, and wound care essentials that provide quick treatment for minor injuries."},"pain-relief":{title:"Pain Relief",desc:"Pain relief products help reduce mild to moderate pain such as headaches, muscle aches, and joint pain."}};function G(){const{slug:t}=S(),{searchTerm:r}=g(a=>a.ui),{user:i}=g(a=>a.auth),m=i?.role==="admin",n=M[t]||{title:"Category",desc:"Explore our products."},{data:l,isLoading:x,isError:o}=$({limit:20,categoryName:n.title,search:r}),h=l?.data||[];return e.jsx("div",{className:"flex justify-center items-center px-4 w-full",children:e.jsxs("div",{className:"w-full mt-20 mb-10 p-8 rounded-2xl bg-white dark:bg-[#2c2c2c] text-black dark:text-[#f1f1f1] shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-2xl mb-3 border-l-4 border-green-500 pl-3",children:n.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed text-lg",children:n.desc})]}),m&&e.jsxs(u,{to:"/admin/add-product",className:"bg-green-700 hover:bg-green-800 text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-md shrink-0",children:[e.jsx(E,{className:"w-5 h-5","aria-hidden":"true"}),"Add New Product"]})]}),x?e.jsx("div",{className:"flex justify-center items-center h-64 text-green-600",children:e.jsx(c,{className:"w-10 h-10 animate-spin","aria-hidden":"true"})}):o?e.jsx("div",{className:"text-red-500 text-center mt-10 text-xl font-bold",children:"Error loading products."}):e.jsx(B,{products:h})]})})}export{G as default};
