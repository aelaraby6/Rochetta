import{k as A,u as C,a as S,l as P,g as B,r as I,j as e,L as i,o as F,S as q,z as n}from"./index-OeRRBTJr.js";import{s as z}from"./strip-DP0bM5wo.js";function T(){const{id:b}=A(),o=C(),{isAuthenticated:u}=S(t=>t.auth),{data:f,isLoading:j,isError:y}=P(b),[k,{isLoading:s}]=B(),[l,c]=I.useState(null),r=f?.data;if(j)return e.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:e.jsx(i,{className:"w-12 h-12 animate-spin text-green-700"})});if(y||!r)return e.jsxs("div",{className:"mt-40 text-center dark:text-white",children:[e.jsx("p",{className:"text-2xl mb-4 font-semibold",children:"Product not found"}),e.jsx("button",{className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",onClick:()=>o(-1),children:"Go back"})]});const x=r.stock!==void 0?r.stock:r.pieces||0,N=r.description||r.desc||"",a=x<=0,d=r.requires_prescription||r.IsRoshetta,m=r.has_strips||r.stripsPerBox>0,g=r.strip_count||r.stripsPerBox||1,w=F(r.image)||"/placeholder.png",p=async t=>{if(!u){n.error("Please login to add items");return}c(t);let h=1;t==="strip"&&m&&g>0&&(h=Number((1/Math.max(1,g)).toFixed(6)));try{await k({productId:r._id,quantity:h}).unwrap(),n.success("Item added to cart!")}catch(v){n.error(v.data?.message||"Failed to add item")}finally{c(null)}};return e.jsx("div",{className:"max-w-6xl mx-auto mt-28 px-4 sm:px-6 lg:px-8 mb-20 text-black dark:text-white transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-10 bg-white dark:bg-[#2c2c2c] p-8 rounded-3xl shadow-xl border border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"w-full md:w-1/2 flex justify-center items-center bg-white rounded-3xl p-8 shadow-sm border border-gray-100 dark:border-gray-700",children:e.jsx("img",{src:w,alt:r.name,className:"max-h-[320px] w-auto object-contain",loading:"eager",fetchpriority:"high",decoding:"async"})}),e.jsxs("div",{className:"w-full md:w-1/2 flex flex-col justify-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:r.name}),e.jsxs("p",{className:"text-3xl font-black text-green-700 dark:text-green-400 mb-6",children:["$",r.price]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg mb-8 leading-relaxed whitespace-pre-wrap",children:N}),e.jsxs("div",{className:"mb-8 border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsxs("p",{className:"text-lg mb-2 flex items-center gap-2",children:[e.jsxs("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:["Available Stock:"," "]}),e.jsxs("span",{className:`font-bold ${a?"text-red-600":"text-green-700 dark:text-green-400"}`,children:[x," pieces"]})]}),d&&e.jsx("p",{className:"text-red-700 dark:text-red-400 font-bold bg-red-50 dark:bg-red-900/20 inline-block px-4 py-1.5 rounded-lg mt-2 border border-red-200 dark:border-red-800",children:"⚠️ Requires Medical Prescription"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mt-auto",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsx("button",{"aria-label":`Add one box of ${r.name} to cart`,className:"flex-1 bg-green-700 hover:bg-green-800 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl transition-transform active:scale-95 shadow-md flex justify-center items-center gap-2 text-lg",onClick:()=>p("box"),disabled:a||s||d,children:s&&l==="box"?e.jsx(i,{className:"w-6 h-6 animate-spin","aria-hidden":"true"}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-6 h-6","aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Box"}),e.jsx("span",{className:"sm:hidden",children:"Box"})]})}),m&&e.jsx("button",{"aria-label":`Add one strip of ${r.name} to cart`,className:"flex-1 bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:hover:bg-green-900/50 disabled:opacity-50 disabled:cursor-not-allowed font-bold py-4 rounded-xl transition-transform active:scale-95 shadow-sm flex justify-center items-center gap-2 text-lg border border-green-200 dark:border-green-800",onClick:()=>p("strip"),disabled:a||s||d,children:s&&l==="strip"?e.jsx(i,{className:"w-6 h-6 animate-spin","aria-hidden":"true"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:z,alt:"strip icon",className:"w-8 h-8 object-contain"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Strip"}),e.jsx("span",{className:"sm:hidden",children:"Strip"})]})})]}),e.jsx("button",{className:"px-8 py-4 border-2 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500 font-bold rounded-xl transition-colors text-lg",onClick:()=>o(-1),children:"Back"})]})]})]})})}export{T as default};
