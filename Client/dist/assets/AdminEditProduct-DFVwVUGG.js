import{c as _,k as S,u as B,l as F,w as q,x as C,r as x,j as e,L as p,z as b}from"./index-D8XKaJer.js";import{u as I,a as D,o as L,b as A,s as n}from"./schemas-Cw1jXD5e.js";import{A as E}from"./arrow-left-DiPD6wWg.js";import{P as u,D as M}from"./package-Mwv3Sw9P.js";import{P as R,T as z,F as T,I as U,S as G,n as o}from"./coerce-Dj_VcUUH.js";const H=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Q=_("save",H),V=L({name:n().min(3,"Name must be at least 3 characters"),price:o().positive("Price must be greater than 0"),pieces:o().int().nonnegative("Pieces cannot be negative"),stripsPerBox:o().int().nonnegative().default(0),category:n().min(1,"Category is required"),desc:n().min(5,"Description is too short"),requires_prescription:A().default(!1)});function Y(){const{id:d}=S(),l=B(),{data:f,isLoading:y}=F(d),{data:h}=q(),[j,{isLoading:c}]=C(),r=f?.data,N=h?.data||[],[g,k]=x.useState(null),{register:i,handleSubmit:v,reset:m,formState:{errors:a}}=I({resolver:D(V)});x.useEffect(()=>{r&&m({name:r.name,price:r.price,pieces:r.stock??r.pieces??0,stripsPerBox:r.strip_count??r.stripsPerBox??0,category:r.category?._id||r.category||"",desc:r.description||r.desc||"",requires_prescription:r.requires_prescription||r.IsRoshetta||!1})},[r,m]);const w=async s=>{const t=new FormData;t.append("name",s.name),t.append("price",s.price),t.append("stock",s.pieces),t.append("category",s.category),t.append("description",s.desc),t.append("requires_prescription",s.requires_prescription),t.append("has_strips",s.stripsPerBox>0?"true":"false"),t.append("strip_count",s.stripsPerBox),g&&t.append("image",g);try{await j({id:d,data:t}).unwrap(),b.success("Product updated successfully"),l(-1)}catch(P){b.error(P.data?.message||"Failed to update product")}};return y?e.jsx("div",{className:"flex justify-center items-center mt-40",children:e.jsx(p,{className:"w-12 h-12 animate-spin text-green-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto mt-12 p-8 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-between mb-8 pb-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>l(-1),className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:e.jsx(E,{className:"w-5 h-5 text-gray-700 dark:text-gray-300"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Edit Product"})]})}),e.jsxs("form",{onSubmit:v(w),className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Product Name"})]}),e.jsx("input",{...i("name"),className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all"}),a.name&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.name.message})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Price"})]}),e.jsx("input",{type:"number",step:"0.01",...i("price"),className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all"}),a.price&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.price.message})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Available Pieces"})]}),e.jsx("input",{type:"number",...i("pieces"),className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all"}),a.pieces&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.pieces.message})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Strips per Box"})]}),e.jsx("input",{type:"number",...i("stripsPerBox"),className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all"}),a.stripsPerBox&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.stripsPerBox.message})]}),e.jsxs("div",{className:"flex flex-col gap-1 md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Category"})]}),e.jsxs("select",{...i("category"),className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all",children:[e.jsx("option",{value:"",children:"Select a Category"}),N.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]}),a.category&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.category.message})]}),e.jsxs("div",{className:"flex flex-col gap-1 md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(T,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Description"})]}),e.jsx("textarea",{...i("desc"),rows:"3",className:"p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 outline-none transition-all resize-none"}),a.desc&&e.jsx("span",{className:"text-red-500 text-sm font-semibold",children:a.desc.message})]}),e.jsxs("div",{className:"flex flex-col gap-1 md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("label",{className:"font-semibold",children:"Update Product Image"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>k(s.target.files[0]),className:"p-2 w-full text-sm text-gray-900 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer bg-gray-50 dark:bg-gray-700 focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"})]}),e.jsxs("div",{className:"flex items-center gap-3 md:col-span-2 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx(G,{className:"w-6 h-6 text-red-600"}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow",children:[e.jsx("input",{type:"checkbox",id:"prescription",...i("requires_prescription"),className:"w-5 h-5 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500 dark:focus:ring-red-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer"}),e.jsx("label",{htmlFor:"prescription",className:"text-red-900 dark:text-red-400 font-bold cursor-pointer select-none",children:"Requires Medical Prescription"})]})]}),e.jsx("div",{className:"md:col-span-2 mt-4",children:e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-bold py-4 px-6 rounded-xl transition-all active:scale-[0.98] shadow-lg flex justify-center items-center gap-2 text-lg",children:c?e.jsx(p,{className:"w-6 h-6 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-6 h-6"})," Save Changes"]})})})]})]})}export{Y as default};
